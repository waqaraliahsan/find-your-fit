(sign-up code omitted for brevity in this snippet)