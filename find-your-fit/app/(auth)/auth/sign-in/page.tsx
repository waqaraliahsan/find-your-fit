(sign-in code omitted for brevity in this snippet)